# Shut up and don't beep on error
setopt no_beep
# Print a warning message when a global parameter is created in a function by an assignment
setopt warn_create_global
# Offer to fix spelling fuckups for commands
setopt correct
# Offer to fix spelling fuckups for arguments
setopt correct_all
# Super GLOB
setopt extended_glob
# zmv support
autoload -U zmv

# ==== Customize $FPATH =====
typeset -U fpath
fpath=(
  $XDG_CONFIG_HOME/zsh/functions/
  $fpath
)

# ===== Customize $PATH =====
# U for Unique, like a set;
# (N) == only if exists
typeset -U path
path=(
  $HOMEBREW_PREFIX/bin(N)
  $RUBY_PATH/bin(N)
  $GEM_HOME/bin(N)
  $CONFIG_HOME/pypoetry/bin(N)
  $HOME/.local/bin
  {{- if eq .chezmoi.os "darwin" }}
  $HOME/.local/bin/darwin
  {{ else }}
  $HOME/.local/bin/linux(N)
  {{ end -}}
  $PYENV_ROOT/bin(N)
  /usr/local/sbin
  "/Applications/Visual Studio Code.app/Contents/Resources/app/bin"(N)
  $path
)

# Source any file with a *.zsh extension. They have additional settings.
for zsh_file ($ZDOTDIR/*.zsh) source $zsh_file

{{- if eq .chezmoi.os "darwin" }}
# Compiling stuff on OS X
[[ -e $commands[brew] ]] && export ARCHFLAGS="-arch {{ .chezmoi.arch }}"
{{- end }}

# PyEnv
if [[ -x $(which pyenv) ]]; then
  eval "$(pyenv init --path)"
  eval "$(pyenv virtualenv-init -)"
fi

# Set up gpg-agent automatically for every shell
if [ -f $HOME/.gnupg/.gpg-agent-info ] && [ -n "$(pgrep gpg-agent)" ]; then
    source $HOME/.gnupg/.gpg-agent-info
    export GPG_AGENT_INFO
else
    eval $(gpg-agent --daemon)
fi

# 1Password CLI
# https://developer.1password.com/docs/cli
eval "$(op completion zsh)"; compdef _op op

# AutoJump
# https://olivierlacan.com/posts/cd-is-wasting-your-time/
[ -f {{ env "HOMEBREW_PREFIX" }}/etc/profile.d/autojump.sh ] && . {{ env "HOMEBREW_PREFIX" }}/etc/profile.d/autojump.sh

# iTerm 2 Integration
test -e "${ZDOTDIR}/.iterm2_shell_integration.zsh" && source "${ZDOTDIR}/.iterm2_shell_integration.zsh"

